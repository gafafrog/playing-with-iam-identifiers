<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IAMで感じるコンピューターサイエンスの基礎</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Noto+Sans+JP:wght@400;700;900&display=swap" rel="stylesheet">
    <!-- Prism CSS for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <style>
        html {
            scroll-snap-type: y mandatory;
        }
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background-color: #111827; /* Dark Gray */
            color: #F3F4F6; /* Light Gray */
        }
        .slide {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* Align content block to the top */
            align-items: center;
            padding: 5rem 4rem;
            border-bottom: 1px solid #374151;
            scroll-snap-align: start;
            scroll-snap-stop: always;
        }
        .slide-content {
            max-width: 1200px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            /* Make content area fill the slide's vertical space */
            flex: 1;
        }
        h2.slide-title {
            font-size: 3.75rem;
            font-weight: 900;
            text-align: center;
            letter-spacing: -0.025em;
            width: 100%;
            margin-bottom: 4rem;
            /* Prevent title from shrinking */
            flex-shrink: 0;
        }
        .slide-body {
            width: 100%;
            /* Make the body fill the remaining space */
            flex-grow: 1;
            /* Center its content vertically and horizontally */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            /* Set a base font size for all text content inside the body */
            font-size: 3rem; /* Increased base font size */
            line-height: 1.6;
        }
        /* PrismJS overrides for better integration */
        pre[class*="language-"] {
            border: 1px solid #374151;
            border-radius: 0.5rem;
            padding: 1.5rem;
            overflow-x: auto;
            font-size: 1rem; /* Keep code font size the same */
            line-height: 1.7;
        }
        code[class*="language-"],
        pre[class*="language-"] {
            font-family: 'Menlo', 'Monaco', 'Consolas', "Liberation Mono", "Courier New", monospace;
        }
        a {
            color: #60A5FA;
            text-decoration: underline;
        }
        /* Special style for title-only slides to center content vertically */
        .slide.is-centered {
            justify-content: center; /* This vertically centers the content */
            padding-top: 0;
            padding-bottom: 0;
        }
        .slide.is-centered .slide-content {
            flex-grow: 0; /* Stop the content block from filling the space, allowing it to be centered */
        }
        .slide.is-centered .slide-title {
            margin-bottom: 0; /* Remove bottom margin for perfect centering */
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100">

    <main>
        <!-- スライド1：タイトル -->
        <section class="slide is-centered">
            <div class="slide-content text-center">
                <h2 class="slide-title">IAMで感じる<br>コンピューターサイエンスの基礎</h2>
            </div>
        </section>

        <!-- スライド2：自己紹介 -->
        <section class="slide">
            <div class="slide-content">
                <h2 class="slide-title">わたしについて</h2>
                <div class="slide-body">
                    <div class="grid md:grid-cols-3 gap-8 items-center">
                        <div class="flex justify-center">
                            <img src="https://unavatar.io/twitter/gafafrog" alt="gafafrogさんのXプロフィール画像" class="rounded-full w-72 h-72 object-cover shadow-lg">
                        </div>
                        <div class="md:col-span-2 space-y-4">
                            <p><a href="https://x.com/gafafrog" target="_blank">@gafafrog</a></p>
                            <p>IAMのソフトウェアエンジニア</p>
                            <p>採用してます！</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- スライド3：IAM Identifiers (Live Demo) -->
        <section class="slide">
            <div class="slide-content">
                <h2 class="slide-title">IAM Identifiers</h2>
                <div class="slide-body">
                    <div class="w-full">
                        <p class="mb-8 text-center">参考: <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html" target="_blank">IAM identifiers - AWS Identity and Access Management</a></p>
                        <pre><code class="language-bash">aws iam list-users --max-items 5 --query 'Users[].UserId' --output text | tr '\t' '\n'
aws iam list-roles --max-items 5 --query 'Roles[].RoleId' --output text | tr '\t' '\n'</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- スライド4：実行結果 -->
        <section class="slide">
            <div class="slide-content">
                <h2 class="slide-title">IAM Identifiers</h2>
                <div class="slide-body">
                    <pre class="w-full"><code class="language-bash"># User IDs
$ aws iam list-users --max-items 5 --query 'Users[].UserId' --output text | tr '\t' '\n'
AIDA<span class="bg-yellow-500 text-black">VI363QCF</span>CID3DLLFU
AIDA<span class="bg-yellow-500 text-black">VI363QCF</span>BHNTIMT5Z

# Role IDs
$ aws iam list-roles --max-items 5 --query 'Roles[].RoleId' --output text | tr '\t' '\n'
AROA<span class="bg-yellow-500 text-black">VI363QCF</span>FRQNZPFCM
AROA<span class="bg-yellow-500 text-black">VI363QCF</span>CHVWR6WLJ
AROA<span class="bg-yellow-500 text-black">VI363QCF</span>F7FBH4ESB
AROA<span class="bg-yellow-500 text-black">VI363QCF</span>JX2T55E5U
AROA<span class="bg-yellow-500 text-black">VI363QCF</span>DBDJZ2YYT</code></pre>
                </div>
            </div>
        </section>

        <!-- スライド5: AWSアカウントID -->
        <section class="slide">
            <div class="slide-content">
                <h2 class="slide-title">AWSアカウントID</h2>
                <div class="slide-body">
                    <ul class="space-y-8 list-disc list-inside text-center mb-36">
                        <li>12桁の数列</li>
                        <li>秘密...？</li>
                    </ul>
                    <p class="text-center">参考: <a href="https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-identifiers.html" target="_blank">View AWS account identifiers - AWS Account Management</a></p>
                </div>
            </div>
        </section>

        <!-- スライド6：エンコーディング -->
        <section class="slide">
            <div class="slide-content">
                <h2 class="slide-title">エンコーディング</h2>
                <div class="slide-body">
                    <p class="text-center">なんでしょうね</p>
                </div>
            </div>
        </section>

        <!-- スライド7：Base32！ -->
        <section class="slide">
            <div class="slide-content">
                <h2 class="slide-title">エンコーディング</h2>
                <div class="slide-body">
                    <div class="w-full">
                        <p class="mb-4 text-center">参考: <a href="https://en.wikipedia.org/wiki/Base32" target="_blank">Base32 - Wikipedia</a></p>
                        <pre><code class="language-python"># b32_to_bits.py を作成
cat &lt;&lt; 'EOF' &gt; b32_to_bits.py
import sys

BASE32_ALPHABET = "ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"
DECODE_MAP = {char: index for index, char in enumerate(BASE32_ALPHABET)}

def base32_to_bit_array(b32_string):
    bit_string = ""
    for char in b32_string.upper():
        if char in DECODE_MAP:
            value = DECODE_MAP[char]
            bit_string += format(value, '05b')
    return bit_string

def readable_array(arr, chunk_size):
    chunks = [arr[i:i+chunk_size] for i in range(0, len(arr), chunk_size)]
    return " ".join(chunks)

if __name__ == '__main__':
    iam_id_part = sys.argv[1]
    bit_array = base32_to_bit_array(iam_id_part)
    array_as_str = readable_array(bit_array, 5)

    print(f"Base32文字列: {iam_id_part}")
    print(f"ビット配列: {array_as_str}")
EOF

# スクリプトを実行
python3 b32_to_bits.py "ABCDE"</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- スライド8：ビット遊び -->
        <section class="slide">
            <div class="slide-content">
                <h2 class="slide-title">ビット遊び</h2>
                <div class="slide-body">
                    <pre class="w-full"><code class="language-text">$ python3 b32_to_bits.py "ABCDE"
Base32文字列: ABCDE
ビット配列: 00000 00001 00010 00011 00100

$ python3 b32_to_bits.py "AIDAVI363QCFCID3DLLFU"
Base32文字列: AIDAVI363QCFCID3DLLFU
ビット配列: 00000 01000 00011 00000 10101 01000 11011 11110 11011 10000 00010 00101 00010 01000 00011 11011 00011 01011 01011 00101 10100</code></pre>
                </div>
            </div>
        </section>

        <!-- スライド9：ビット遊び -->
        <section class="slide">
            <div class="slide-content">
                <h2 class="slide-title">ビット遊び</h2>
                <div class="slide-body">
                    <pre class="w-full"><code class="language-python"># find_account_id.py を作成
cat &lt;&lt; 'EOF' &gt; find_account_id.py
import sys
import b32_to_bits as b32

BASE32_ALPHABET = "ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"
DECODE_MAP = {char: index for index, char in enumerate(BASE32_ALPHABET)}

def find_12_digits(bit_array, looking_for=None):
    '''開始位置を一つずつずらしつつ、配列の中で連続した40ビットを整数にして出力する。
    '''
    for shift in range(len(bit_array) - 40):
        # 開始位置をずらし、40ビット分を切り出す
        bit_chunk = bit_array[shift : shift + 40]

        # 切り出したビットの塊を整数に変換
        candidate = int(bit_chunk, 2)

        candidate_as_str = '{:0>12}'.format(str(candidate)[:12])
        found = " &lt;== Found!!" if candidate_as_str == looking_for else ""
        print(f"開始 {shift:2d} bit目: {candidate_as_str}{found}")

if __name__ == '__main__':
    if len(sys.argv) < 2:
        print("エラー: 解析するIDを引数として渡してください。")
        sys.exit(1)

    iam_id_part = sys.argv[1]
    looking_for = sys.argv[2] if len(sys.argv) > 2 else None
    bit_array = b32.base32_to_bit_array(iam_id_part)
    array_as_str = b32.readable_array(bit_array, 5)

    print(f"Base32文字列: {iam_id_part}")
    print(f"ビット配列: {array_as_str}")
    find_12_digits(bit_array, looking_for)
EOF

# ID全体を渡して実行
python3 find_account_id.py "AIDAVI363QCFCID3DLLFU" "362653909130"</code></pre>
                </div>
            </div>
        </section>

        <!-- スライド10：アカウントID、発見！ -->
        <section class="slide">
            <div class="slide-content">
                <h2 class="slide-title">アカウントID！</h2>
                <div class="slide-body">
                    <pre class="w-full"><code class="language-text">$ python3 find_account_id.py "AIDAVI363QCFCID3DLLFU" "362653909130"
Base32文字列: AIDAVI363QCFCID3DLLFU
ビット配列: 00000 01000 00011 00000 10101 01000 11011 11110 11011 10000 00010 00101 00010 01000 00011 11011 00011 01011 01011 00101 10100
開始  0 bit目: 008691295102
開始  1 bit目: 017382590205
開始  2 bit目: 034765180411
開始  3 bit目: 069530360822
開始  4 bit目: 139060721645
開始  5 bit目: 278121443291
開始  6 bit目: 556242886583
開始  7 bit目: 012974145390
開始  8 bit目: 025948290780
開始  9 bit目: 051896581560
開始 10 bit目: 103793163120
開始 11 bit目: 207586326240
開始 12 bit目: 415172652480
開始 13 bit目: 830345304960
開始 14 bit目: 561178982145
開始 15 bit目: 022846336514
開始 16 bit目: 045692673028
開始 17 bit目: 091385346056
開始 18 bit目: 182770692113
開始 19 bit目: 365541384226
開始 20 bit目: 731082768453
<span class="bg-yellow-500 text-black font-bold p-1 rounded">開始 21 bit目: 362653909130 <== Found!!</span>
開始 22 bit目: 72530781826
...</code></pre>
                </div>
            </div>
        </section>

        <!-- スライド11：他の取得方法 -->
        <section class="slide">
            <div class="slide-content">
                <h2 class="slide-title">他の取得方法</h2>
                <div class="slide-body">
                    <div class="w-full max-w-2xl">
                        <div class="mb-24">
                            <h3 class="font-bold mb-2 text-center">方法1：IAMコンソール</h3>
                            <p class="text-center">ちょっとハックだけどできる。</p>
                        </div>
                        <div>
                            <h3 class="font-bold mb-2 text-center">方法2：AWS CLI</h3>
                            <p class="text-center">実はそれ用のAPIがちゃんとある。</p>
                            <pre class="mt-4"><code class="language-bash">$ aws sts get-access-key-info --access-key-id AKIAIOSFODNN7EXAMPLE

{
    "Account": "123456789012"
}</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- スライド12：まとめ -->
        <section class="slide">
            <div class="slide-content">
                <h2 class="slide-title">まとめ</h2>
                <div class="slide-body">
                    <p class="mb-20">今日やったこと</p>
                    <ul class="space-y-8 list-disc list-inside text-center">
                        <li>エンコーディング (Base32)</li>
                        <li>ビット演算</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- スライド13：おしまい -->
        <section class="slide is-centered">
            <div class="slide-content text-center">
                <h2 class="slide-title text-8xl">おしまい</h2>
            </div>
        </section>

    </main>

    <!-- Prism JS for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>
